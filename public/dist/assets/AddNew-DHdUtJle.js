import{r,a as q,e as h,f as i,j as e,S as b,g as d,h as I,i as x,k as P,l as T,m as B,n as C,o as L,p as A}from"./index-DbPeGsxX.js";import{u as M}from"./index.esm-Cg6BTQLn.js";import{F as O}from"./index-DwwmK9Mx.js";function z(){const[c,j]=r.useState([]),[m,g]=r.useState(!1),[y,N]=r.useState(""),[w,v]=r.useState(0),u=q(),S=h(d,"galleries");i(x,"/galleries/");const{register:f,handleSubmit:F,reset:k,getValues:U,watch:p}=M(),D=t=>{const s=t.img[0],a=t.text;let l="";k();const o=I(i(x,`/galleries/${s.name}`),s);o.on("state_changed",n=>{const E=Math.round(n.bytesTransferred/n.totalBytes*100);v(E)},n=>console.log(n),()=>{P(o.snapshot.ref).then(n=>{l=n,T(h(d,"galleries"),{image:l,title:a}).then(()=>u(0))})})},R=(t,s)=>{g(!0);let a=i(x,t),l=B(d,"/galleries/",s);C(l).then(()=>{L(a).then(()=>{g(!1),u(0)}).catch(o=>console.log(o))})};return r.useEffect(()=>{var s;let t=(s=p("img")[0])==null?void 0:s.name;N(t)},[p("img")]),r.useEffect(()=>{async function t(){(await A(S)).forEach(a=>{j(l=>[...l,{...a.data(),docId:a.id}])})}t()},[]),e.jsxs("div",{className:"flex flex-col items-end text-right w-full pt-10 overflow-x-hidden",children:[m?e.jsx(b,{}):e.jsx("div",{className:"flex flex-col items-center justify-center gap-2  bg-white rounded-lg max-h-[800px] overflow-y-scroll  text-black w-full mt-2  py-3 px-5",children:c.length?c.map((t,s)=>e.jsxs("div",{className:"flex items-center gap-x-3",children:[e.jsx(O,{className:"cursor-pointer",onClick:()=>R(t.image,t.docId)}),e.jsx("img",{className:"w-[200px]",src:t.image},s),e.jsx("span",{children:c.title})]},s)):e.jsx("p",{children:"there are no images"})}),e.jsxs("p",{className:"w-full py-5 text-center",children:["Percent: ",w]}),e.jsx("div",{className:"text-2xl text-default font-bold mb-4 mt-5",children:"إضافة صورة"}),m?e.jsx(b,{}):e.jsx("form",{onSubmit:F(D),className:"w-full flex flex-col gap-2",children:e.jsxs("div",{className:"flex flex-col gap-3 ",children:[e.jsxs("label",{htmlFor:"img",className:"bg-green-500 flex justify-start flex-row-reverse gap-x-2 hover:bg-green-700 text-white py-2 px-2 rounded-md cursor-pointer",children:["أضف صورة جديدة",e.jsx("input",{...f("img",{required:"File is required"}),type:"file",id:"img",className:"hidden"}),e.jsx("span",{children:y})]}),e.jsxs("label",{htmlFor:"text",className:"bg-green-500 flex flex-col justify-start gap-x-3 gap-y-3 hover:bg-green-700 text-white py-2 px-2 rounded-md cursor-pointer",children:["أضف  نص الصورة",e.jsx("input",{...f("text",{required:"File is required"}),type:"text",id:"text",className:"rounded text-end py-1 grow text-black outline-none px-2"})]}),e.jsx("button",{type:"submit",className:"mb-5 mt-10 py-2 bg-default rounded-md text-white bg-black font-bold text-center",children:"نشر"})]})})]})}export{z as default};
